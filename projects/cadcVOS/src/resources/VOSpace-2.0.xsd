<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:vos="http://www.ivoa.net/xml/VOSpace/v2.0" xmlns:uws="http://www.ivoa.net/xml/UWS/v1.0" xmlns:xlink="http://www.w3.org/1999/xlink" targetNamespace="http://www.ivoa.net/xml/VOSpace/v2.0" elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:import namespace="http://www.ivoa.net/xml/UWS/v1.0" schemaLocation="http://www.ivoa.net/xml/UWS/v1.0"/>

    <!-- ======== Node types ======== -->

    <xs:complexType name="Node">
        <xs:annotation>
            <xs:documentation>
                The base class for all nodes.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="properties" type="vos:PropertyList" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        The list of node properties.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="uri" type="xs:anyURI" use="required">
            <xs:annotation>
                <xs:documentation>
                    The node identifier URI.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>

    <xs:complexType name="DataNode">
        <xs:annotation>
            <xs:documentation>
                The base class for data nodes.
            </xs:documentation>
        </xs:annotation>
        <xs:complexContent>
            <xs:extension base="vos:Node">
                <xs:sequence>
                    <xs:element name="accepts" type="vos:ViewList" minOccurs="0" maxOccurs="1">
                        <xs:annotation>
                            <xs:documentation>
                                The list of views or data formats that this node can accept.
                                A simple unstructured node may accept data in any format.
                                A structured node may only accept data in specific formats.
                            </xs:documentation>
                        </xs:annotation>
                    </xs:element>
                    <xs:element name="provides" type="vos:ViewList" minOccurs="0" maxOccurs="1">
                        <xs:annotation>
                            <xs:documentation>
                                The list of views or data formats that this node can provide.
                                A simple unstructured node may only provide access to the data in the original format.
                                A structured node may provide different views of the data generated by the service.
                            </xs:documentation>
                        </xs:annotation>
                    </xs:element>
                    <xs:element name="capabilities" type="vos:CapabilityList" minOccurs="0" maxOccurs="1">
                        <xs:annotation>
                            <xs:documentation>
                                The list of capabilities that this node can support.
                            </xs:documentation>
                        </xs:annotation>
                    </xs:element>
                </xs:sequence>
                <xs:attribute name="busy" type="xs:boolean" use="optional" default="false">
                    <xs:annotation>
                        <xs:documentation>
                            A flag to indicate if the node content is available.
                            This will be set to false while the data is being imported,
                            or if the underlying service is busy.
                        </xs:documentation>
                    </xs:annotation>
                </xs:attribute>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="UnstructuredDataNode">
        <xs:annotation>
            <xs:documentation>
                An unstructured data node, containing unspecified content.
                The service does not need to understand or interpret the content.
                This type of node can accept any format, and only provides one view returning the original data.
            </xs:documentation>
        </xs:annotation>
        <xs:complexContent>
            <xs:extension base="vos:DataNode"/>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="StructuredDataNode">
        <xs:annotation>
            <xs:documentation>
                A structured data node, containing a specific data format that the service has understands.
                This type of node may only accept specific data formats, and provide different views of the
                data generated by the service.
            </xs:documentation>
        </xs:annotation>
        <xs:complexContent>
            <xs:extension base="vos:DataNode"/>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="ContainerNode">
        <xs:annotation>
            <xs:documentation>
                A container node containing any type of node.
            </xs:documentation>
        </xs:annotation>
        <xs:complexContent>
            <xs:extension base="vos:DataNode">
                <xs:sequence>
                    <xs:element name="nodes" minOccurs="1" maxOccurs="1">
                        <xs:annotation>
                            <xs:documentation>
                                A list of the direct children that the container has.
                            </xs:documentation>
                        </xs:annotation>
                        <xs:complexType>
                            <xs:sequence>
                                <xs:element name="node" type="vos:Node" minOccurs="0" maxOccurs="unbounded">
                                    <!--<xs:attribute name="uri" type="xs:anyURI" use="required">-->
                                        <!--<xs:annotation>-->
                                            <!--<xs:documentation>-->
                                                <!--The node identifier URI.-->
                                            <!--</xs:documentation>-->
                                        <!--</xs:annotation>-->
                                    <!--</xs:attribute>-->
                                </xs:element>
                            </xs:sequence>
                        </xs:complexType>
                    </xs:element>
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

    <xs:complexType name="LinkNode">
        <xs:annotation>
            <xs:documentation>
                A node that points to another resource.
            </xs:documentation>
        </xs:annotation>
        <xs:complexContent>
            <xs:extension base="vos:Node">
                <xs:sequence>
                    <xs:element name="target" type="xs:anyURI" minOccurs="1" maxOccurs="1">
                        <xs:annotation>
                            <xs:documentation>
                                The identifier for the object that the LinkNode points to.
                            </xs:documentation>
                        </xs:annotation>
                    </xs:element>
                </xs:sequence>
            </xs:extension>
        </xs:complexContent>
    </xs:complexType>

    <!-- ======== Property types ======== -->

    <xs:complexType name="Property">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attributeGroup ref="vos:PropertyAttribute"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="PropertyList">
        <xs:annotation>
            <xs:documentation>
                A container element for a list of properties.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="property" type="vos:Property" minOccurs="0" maxOccurs="unbounded" nillable="true"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="PropertyReference">
        <xs:annotation>
            <xs:documentation>
                A reference to a property description, used in getProperties()
            </xs:documentation>
        </xs:annotation>
        <xs:attributeGroup ref="vos:PropertyAttribute"/>
    </xs:complexType>

    <xs:complexType name="PropertyReferenceList">
        <xs:annotation>
            <xs:documentation>
                A container element for a list of property references.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="property" type="vos:PropertyReference" minOccurs="0" maxOccurs="unbounded" nillable="true"/>
        </xs:sequence>
    </xs:complexType>

    <xs:attributeGroup name="PropertyAttribute">
        <xs:attribute name="uri" type="xs:anyURI" use="required">
            <xs:annotation>
                <xs:documentation>
                    If the property has been registered, then the URI should point to the registration document.
                    Third party tools may use the urn:xxxx syntax to add unregistered properties.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <!--
            The VOSpace 20101112 schema defines the readOnly attribute as "optional" not "required",
            and adds default="false". Also in the 20101112 schema readOnly is all lower-case.
        -->
        <xs:attribute name="readOnly" type="xs:boolean" use="required">
            <xs:annotation>
                <xs:documentation>
                    A flag to indicate if the property is considered read-only.
                    Attempting to modify a read-only property should generate a PermissionDenied fault.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <!--
        <xs:attribute name="xs:nill" type="xs:boolean" use="optional" default="false">
            <xs:annotation>
                <xs:documentation>
                    A flag to indicate if the property is null and should be deleted.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
        -->
    </xs:attributeGroup>

    <xs:complexType name="GetPropertiesResponse">
        <xs:sequence>
            <xs:element name="accepts" type="vos:PropertyReferenceList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the properties that the service accepts and understands.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="provides" type="vos:PropertyReferenceList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the properties that the service provides.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="contains" type="vos:PropertyReferenceList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for all the properties currently used by nodes within the service.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <!-- ======== View types ======== -->

    <xs:complexType name="Param">
        <xs:annotation>
            <xs:documentation>
                A view or protocol parameter.
            </xs:documentation>
        </xs:annotation>
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute name="uri" type="xs:anyURI" use="required"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>

    <xs:complexType name="View">
        <xs:annotation>
            <xs:documentation>
                An element describing a view of a data-set.
                A view may just provide the original data, or it could be server generated.
                Examples of server generated views could include a votable view of data in a database table,
                or a conversion from one image format to another.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="param" type="vos:Param" minOccurs="0" maxOccurs="unbounded" nillable="true">
                <xs:annotation>
                    <xs:documentation>
                        A list of parameters for the view.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="uri" type="xs:anyURI" use="required">
            <xs:annotation>
                <xs:documentation>
                    The view URI.
                    This should point to a resource describing the view format and what parameters it requires.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <xs:attribute name="original" type="xs:boolean" use="optional" default="true">
            <xs:annotation>
                <xs:documentation>
                    A flag to indicate if the view provides access to the original data content or a derived form.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>

    <xs:complexType name="ViewList">
        <xs:annotation>
            <xs:documentation>
                A container element for a list of views.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="view" type="vos:View" minOccurs="0" maxOccurs="unbounded" nillable="true"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="GetViewsResponse">
        <xs:sequence>
            <xs:element name="accepts" type="vos:ViewList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the views that the service can accept.
                        A simple file based system may accept data in 'any' format.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="provides" type="vos:ViewList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the views that the service can provide.
                        A simple file based system may only provide data in the original format.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <!-- ======== Protocol types ======== -->

    <xs:complexType name="Protocol">
        <xs:annotation>
            <xs:documentation>
                A protocol element, containing the protocol URI, the endpoint and any protocol specific parameters.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="endpoint" type="xs:anyURI" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        The target endpoint to use for a data transfer.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="param" type="vos:Param" minOccurs="0" maxOccurs="unbounded" nillable="true">
                <xs:annotation>
                    <xs:documentation>
                        Any additional protocol specific parameters required to use the endpoint.
                        For example, the user name or password to use for ftp access.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="uri" type="xs:anyURI" use="required">
            <xs:annotation>
                <xs:documentation>
                    The protocol identifier.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>

    <xs:complexType name="ProtocolList">
        <xs:annotation>
            <xs:documentation>
                A container element for a list of protocols.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="protocol" type="vos:Protocol" minOccurs="0" maxOccurs="unbounded" nillable="true"/>
        </xs:sequence>
    </xs:complexType>

    <xs:complexType name="GetProtocolsResponse">
        <xs:sequence>
            <xs:element name="accepts" type="vos:ProtocolList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the protocols that the service can accept.
                        This means that the service can act as a client for the protocol.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="provides" type="vos:ProtocolList">
                <xs:annotation>
                    <xs:documentation>
                        A list of identifiers for the protocols that the service can provide.
                        This means that the service can act as a server for the protocol.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>

    <!-- ======== Capability types ======== -->

    <xs:complexType name="Capability">
        <xs:annotation>
            <xs:documentation>
                A capability element, containing the capability URI, the
                endpoint and any capability specific parameters(?).
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="endpoint" type="xs:anyURI" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        The target endpoint to use for the third-part interface.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <!--+
             | Uncommented Capability params.
             +-->
            <xs:element name="param" type="vos:Param" minOccurs="0" maxOccurs="unbounded" nillable="true">
                <xs:annotation>
                    <xs:documentation>
                        Any additional capability specific parameters required to use the endpoint.
                        For example, the user name or password to use for access.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
        <xs:attribute name="uri" type="xs:anyURI" use="required">
            <xs:annotation>
                <xs:documentation>
                    The capability identifier.
                </xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>

    <xs:complexType name="CapabilityList">
        <xs:annotation>
            <xs:documentation>
                A container element for a list of capabilities.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="capability" type="vos:Capability" minOccurs="0" maxOccurs="unbounded" nillable="true"/>
        </xs:sequence>
    </xs:complexType>

    <!-- ======== Node list type ======== -->

    <xs:complexType name="NodeList">
        <xs:annotation>
            <xs:documentation>
                A container element for search responses.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="nodes" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
                        The list of nodes.
                    </xs:documentation>
                </xs:annotation>
                <xs:complexType>
                    <xs:sequence>
                        <xs:element name="node" type="vos:Node" minOccurs="0" maxOccurs="unbounded">
                            <xs:annotation>
                                <xs:documentation>
                                    At the maximum level of detail this will be replaced by the full element for the extended type, using xsi:type to indicate the node type/
                                </xs:documentation>
                            </xs:annotation>
                        </xs:element>
                    </xs:sequence>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
  
  <!-- ======== Transfer type ======== -->
    <xs:complexType name="Transfer">
        <xs:annotation>
            <xs:documentation>
        A container element for transfer operations.
            </xs:documentation>
        </xs:annotation>
        <xs:sequence>
            <xs:element name="target" type="xs:anyURI" minOccurs="1" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
            The target of a transfer operation - the node to/from which data is to be transferred.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="direction" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
            The direction of a data transfer - either a URI or one of the specified directions
                    </xs:documentation>
                </xs:annotation>
                <xs:simpleType>
                    <xs:union>
                        <xs:simpleType>
                            <xs:restriction base="xs:anyURI"/>
                        </xs:simpleType>
                        <xs:simpleType>
                            <xs:restriction base="xs:string">
                                <xs:enumeration value="pushToVoSpace"/>
                                <xs:enumeration value="pushFromVoSpace"/>
                                <xs:enumeration value="pullToVoSpace"/>
                                <xs:enumeration value="pullFromVoSpace"/>
                            </xs:restriction>
                        </xs:simpleType>
                    </xs:union>
                </xs:simpleType>
            </xs:element>
            <xs:element name="view" type="vos:View" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
            The requested view for the transfer.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="protocol" type="vos:Protocol" minOccurs="0" maxOccurs="unbounded">
                <xs:annotation>
                    <xs:documentation>
            The transfer protocol(s) to use.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="keepBytes" type="xs:boolean" minOccurs="0" maxOccurs="1">
                <xs:annotation>
                    <xs:documentation>
            Indicates whether the source object is to be kept in an internal transfer, 
            i.e., distinguishes between a move and a copy.
                    </xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
  <!-- ======== Response representations ======== -->
  
    <xs:element name="protocols" type="vos:ProtocolList"/>

    <xs:element name="views" type="vos:ViewList"/>

    <xs:element name="properties" type="vos:PropertyList"/>

    <xs:element name="transfer" type="vos:Transfer"/>

    <xs:element name="searchDetails" type="vos:NodeList"/>

    <xs:element name="node" type="vos:Node"/>
  
  
</xs:schema>

